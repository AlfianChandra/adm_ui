import{r as c}from"./request-_NsyB8aS.js";import{s as M,a as U,b as A,c as g}from"./index-1Btzc3sr.js";import{d as F,u as G,a as f,b as N,c as y,g as a,h as s,w as o,f as l,F as J,o as r,j as K,A as S,v as b,e as P,i as m}from"./index-BuQ8GHaj.js";import{d as T,t as L,u as q}from"./dayjs.min-fB-8Vcv2.js";import{S as I}from"./SignaturePad-Cg3SCZGf.js";import{s as V}from"./index-CbAGqZEX.js";import{s as u}from"./index-B4i97k-5.js";import{s as D}from"./index-DnXQjg-K.js";import"./index-B2Ww7Ob3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={style:{"padding-left":"10%","padding-right":"10%","padding-top":"5rem","padding-bottom":"2rem",display:"flex","flex-flow":"column",gap:"1rem"}},Q={style:{width:"100%",display:"flex","flex-flow":"column",gap:"1rem"}},W={style:{display:"flex","flex-flow":"row nowrap",width:"40%"}},X={style:{display:"flex","flex-flow":"column"}},Z={key:0},ee={key:1},te={key:0,style:{"font-size":"13px",background:"orange",color:"white",padding:"0.2rem 0.5rem","border-radius":"5px","font-weight":"bold"}},ae={key:1,style:{"font-size":"13px",background:"green",color:"white",padding:"0.2rem 0.5rem","border-radius":"5px","font-weight":"bold"}},se={key:2,style:{"font-size":"13px",background:"red",color:"white",padding:"0.2rem 0.5rem","border-radius":"5px","font-weight":"bold"}},le={key:3,style:{"font-size":"13px",background:"grey",color:"white",padding:"0.2rem 0.5rem","border-radius":"5px","font-weight":"bold"}},oe={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},ne={style:{display:"flex","flex-flow":"column",gap:"0.5rem"}},ie={style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between","align-items":"center"}},re={key:0,style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between","align-items":"center"}},de={style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between","align-items":"center"}},ue={style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",padding:"30px",gap:"0.5rem"}},pe=["src"],fe={style:{width:"250px",display:"flex","flex-flow":"column",gap:"0.5rem"}},ye={style:{width:"250px",display:"flex","flex-flow":"column",gap:"0.5rem"}},me={style:{width:"250px",display:"flex","flex-flow":"column",gap:"0.5rem"}},Pe=F({__name:"ClientHistory",setup(ve){T.extend(L),T.extend(q);const p=G(),$=f([]),z=[{label:"Menunggu",value:"pending"},{label:"Disetujui",value:"approved"},{label:"Ditolak",value:"rejected"},{label:"Draf",value:"draft"},{label:"Semua",value:"all"}],h=f(z[4].value),w=()=>{const n={status:h.value};c.post("pengajuan/history",n).then(e=>{$.value=e.payload}).catch(e=>{console.error(e),p.add({severity:"error",summary:"Error",detail:"Gagal mendapatkan data pengajuan"})})},i=f({}),d=f(!1),k=f(!1),E=n=>{i.value=n,d.value=!0},Y=n=>{if(n==null||n===""){p.add({severity:"warn",summary:"Peringatan",detail:"Tanda tangan tidak boleh kosong"});return}i.value.ttd=n,k.value=!1},x=f(null),B=()=>{c.post("pengajuan/delete",{_id:i.value._id}).then(n=>{p.add({severity:"success",summary:"Berhasil",detail:"Pengajuan berhasil dihapus"}),d.value=!1,w(),x.value.hide()}).catch(n=>{console.error(n),p.add({severity:"error",summary:"Error",detail:"Gagal menghapus pengajuan"})})},j=f(null),H=()=>{c.post("pengajuan/update-status",{_id:i.value._id,status:"draft"}).then(n=>{p.add({severity:"success",summary:"Berhasil",detail:"Pengajuan berhasil ditarik",life:3e3}),d.value=!1,w(),j.value.hide()}).catch(n=>{console.error(n),p.add({severity:"error",summary:"Error",detail:"Gagal menarik pengajuan",life:3e3})})},C=f(null),O=()=>{c.post("pengajuan/update-status",{_id:i.value._id,status:"pending"}).then(n=>{p.add({severity:"success",summary:"Berhasil",detail:"Pengajuan berhasil diajukan",life:3e3}),d.value=!1,w(),C.value.hide()}).catch(n=>{console.error(n),p.add({severity:"error",summary:"Error",detail:"Gagal mengajukan pengajuan",life:3e3})})};return N(()=>{w()}),(n,e)=>{const v=K("fasicon");return r(),y(J,null,[a("div",R,[e[11]||(e[11]=a("div",{style:{width:"100%",display:"flex","flex-flow":"column",gap:"1rem"}},[a("h1",{style:{margin:"0",padding:"0"}},"Pengajuan Saya")],-1)),a("div",Q,[a("div",W,[s(l(M),{variant:"in",style:{width:"100%"}},{default:o(()=>[s(l(A),{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),options:z,"option-label":"label","option-value":"value",style:{width:"100%"},onChange:w},null,8,["modelValue"]),e[10]||(e[10]=a("label",null,"Filter Status",-1))]),_:1,__:[10]})]),a("div",X,[s(l(U),{value:$.value},{default:o(()=>[s(l(g),null,{body:o(({})=>[s(v,{icon:"file-lines"})]),_:1}),s(l(g),{header:"RegisterID",style:{width:"20%"}},{body:o(({data:t})=>[a("code",null,S(t._id),1)]),_:1}),s(l(g),{header:"Diajukan",style:{width:"20%"}},{body:o(({data:t})=>[a("code",null,S(l(T).utc(t.date).tz("Asia/Jakarta").format("ddd, DD MMM YYYY HH:mm:ss")),1)]),_:1}),s(l(g),{header:"Jenis",style:{width:"20%"}},{body:o(({data:t})=>[t.jenis_barang==="inv_common"?(r(),y("span",Z,"Umum")):t.jenis_barang==="inv_laptop"?(r(),y("span",ee,"Khusus (Laptop)")):b("",!0)]),_:1}),s(l(g),{header:"Status",style:{width:"20%"}},{body:o(({data:t})=>[t.status==="pending"?(r(),y("span",te,"Sedang review")):t.status==="approved"?(r(),y("span",ae,"Disetujui")):t.status==="rejected"?(r(),y("span",se,"Ditolak")):t.status==="draft"?(r(),y("span",le,"Draft")):b("",!0)]),_:1}),s(l(g),null,{body:o(({data:t})=>[a("div",oe,[t.status==="draft"?(r(),P(l(u),{key:0,onClick:_=>{C.value.show(_),i.value=t}},{default:o(()=>[s(v,{icon:"paper-plane"})]),_:2},1032,["onClick"])):b("",!0),t.status!=="approved"?(r(),P(l(u),{key:1,class:"p-button-outlined",onClick:_=>E(t)},{default:o(()=>[s(v,{icon:"edit"})]),_:2},1032,["onClick"])):b("",!0),t.status==="draft"?(r(),P(l(u),{key:2,class:"p-button-outlined p-button-danger",onClick:_=>{x.value.show(_),i.value=t}},{default:o(()=>[s(v,{icon:"trash"})]),_:2},1032,["onClick"])):b("",!0)])]),_:1})]),_:1},8,["value"])])])]),s(l(V),{header:"Edit",style:{width:"30vw"},modal:"",visible:d.value,"onUpdate:visible":e[5]||(e[5]=t=>d.value=t)},{default:o(()=>[a("div",ne,[a("div",ie,[e[13]||(e[13]=a("span",{style:{"font-weight":"bold"}},"Perbarui Tanda Tangan",-1)),s(l(u),{disabled:i.value.status!=="draft",onClick:e[1]||(e[1]=t=>k.value=!0)},{default:o(()=>e[12]||(e[12]=[m("Perbarui",-1)])),_:1,__:[12]},8,["disabled"])]),i.value.status!="draft"?(r(),y("div",re,[e[15]||(e[15]=a("span",{style:{"font-weight":"bold"}},"Tarik Proposal",-1)),s(l(u),{class:"p-button-danger",onClick:e[2]||(e[2]=t=>{j.value.show(t)})},{default:o(()=>[s(v,{icon:"times"}),e[14]||(e[14]=m(" Tarik Pengajuan",-1))]),_:1,__:[14]})])):b("",!0),a("div",de,[e[17]||(e[17]=a("span",{style:{"font-weight":"bold"}},"Hapus Proposal",-1)),s(l(u),{disabled:i.value.status!=="draft",class:"p-button-danger",onClick:e[3]||(e[3]=t=>{x.value.show(t)})},{default:o(()=>[s(v,{icon:"trash"}),e[16]||(e[16]=m(" Hapus",-1))]),_:1,__:[16]},8,["disabled"])]),s(l(u),{class:"p-button-outlined",onClick:e[4]||(e[4]=t=>d.value=!1)},{default:o(()=>e[18]||(e[18]=[m("Tutup",-1)])),_:1,__:[18]})])]),_:1},8,["visible"]),s(l(V),{header:"Tanda Tangan",style:{width:"35vw"},modal:"",visible:k.value,"onUpdate:visible":e[6]||(e[6]=t=>k.value=t)},{default:o(()=>[a("div",ue,[e[19]||(e[19]=a("span",null,"TTD saat ini: ",-1)),a("img",{src:i.value.ttd,style:{width:"200px",padding:"10px","border-radius":"10px",border:"1px solid #ccc"}},null,8,pe)]),s(I,{style:{border:"1px solid #ccc"},"onUpdate:signature":Y})]),_:1},8,["visible"]),s(l(D),{ref_key:"deleteOp",ref:x},{default:o(()=>[a("div",fe,[e[21]||(e[21]=a("span",{style:{"font-weight":"bold"}},"Yakin ingin menghapus pengajuan ini?",-1)),e[22]||(e[22]=a("span",{style:{"font-size":"12px"}},"Tindakan ini tidak dapat dibatalkan.",-1)),s(l(u),{class:"p-button-danger",onClick:e[7]||(e[7]=t=>{d.value=!1,B()})},{default:o(()=>e[20]||(e[20]=[m("Ya, Hapus",-1)])),_:1,__:[20]})])]),_:1},512),s(l(D),{ref_key:"draftOp",ref:j},{default:o(()=>[a("div",ye,[e[24]||(e[24]=a("span",{style:{"font-weight":"bold"}},"Tarik proposal ini?",-1)),e[25]||(e[25]=a("span",{style:{"font-size":"12px"}},"Status akan diubah menjadi draf",-1)),s(l(u),{class:"p-button-danger",onClick:e[8]||(e[8]=t=>{d.value=!1,H()})},{default:o(()=>e[23]||(e[23]=[m("Ya, Tarik",-1)])),_:1,__:[23]})])]),_:1},512),s(l(D),{ref_key:"proposeOp",ref:C},{default:o(()=>[a("div",me,[e[27]||(e[27]=a("span",{style:{"font-weight":"bold"}},"Ajukan proposal?",-1)),e[28]||(e[28]=a("span",{style:{"font-size":"12px"}},"Proposal akan diajukan!",-1)),s(l(u),{onClick:e[9]||(e[9]=t=>{d.value=!1,O()})},{default:o(()=>e[26]||(e[26]=[m("Ya, Ajukan",-1)])),_:1,__:[26]})])]),_:1},512)],64)}}});export{Pe as default};
