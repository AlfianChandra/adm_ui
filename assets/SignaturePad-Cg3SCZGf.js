import{d as j,a as q,b as F,c as H,o as J,g as P,a6 as D,h as T,f as X,w as Y,i as M,j as L}from"./index-BuQ8GHaj.js";import{s as R}from"./index-B4i97k-5.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={style:{padding:"10px",display:"flex","flex-flow":"row nowrap",gap:"0.5rem",background:"#eee"}},i=2,G=j({__name:"SignaturePad",emits:["update:signature"],setup(K,{emit:S}){const b=S,c=q(null);let x=null,u=!1,f=[],a,o;F(()=>{const t=c.value,e=500,n=200;t.width=e,t.height=n,x=t.getContext("2d"),a=document.createElement("canvas"),a.width=e*i,a.height=n*i,o=a.getContext("2d"),o.strokeStyle="#000",o.lineWidth=2*i,o.lineCap="round",o.lineJoin="round",w()});const w=()=>{x.clearRect(0,0,c.value.width,c.value.height),x.drawImage(a,0,0,a.width,a.height,0,0,c.value.width,c.value.height)},h=(t,e)=>{const n=t*i,p=e*i;if(f.push({x:n,y:p}),f.length>3){const s=f.slice(-2),r={x:(s[0].x+s[1].x)/2,y:(s[0].y+s[1].y)/2};o.quadraticCurveTo(s[0].x,s[0].y,r.x,r.y),o.stroke(),w()}},B=t=>{u=!0,f=[],o.beginPath(),o.moveTo(t.offsetX*i,t.offsetY*i),h(t.offsetX,t.offsetY)},I=t=>{u&&h(t.offsetX,t.offsetY)},_=()=>{u&&(u=!1,o.closePath(),f=[])},k=(t,e)=>{const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}},E=t=>{const e=k(c.value,t.touches[0]);u=!0,f=[],o.beginPath(),o.moveTo(e.x*i,e.y*i),h(e.x,e.y)},N=t=>{if(!u)return;const e=k(c.value,t.touches[0]);h(e.x,e.y)},V=()=>{o.clearRect(0,0,a.width,a.height),w()},U=()=>{const t=o.getImageData(0,0,a.width,a.height);let{data:e,width:n,height:p}=t,s=n,r=p,g=0,m=0;for(let l=0;l<p;l++)for(let d=0;d<n;d++)e[(l*n+d)*4+3]>0&&(d<s&&(s=d),l<r&&(r=l),d>g&&(g=d),l>m&&(m=l));if(g===0&&m===0){b("update:signature",null);return}const C=g-s+20,y=m-r+20,v=document.createElement("canvas");v.width=C,v.height=y,v.getContext("2d").drawImage(a,s-10,r-10,C,y,0,0,C,y);const W=v.toDataURL("image/png");b("update:signature",W)};return(t,e)=>{const n=L("fasicon");return J(),H("div",null,[P("canvas",{ref_key:"canvasRef",ref:c,class:"signature-canvas",onMousedown:B,onMousemove:I,onMouseup:_,onMouseleave:_,onTouchstart:D(E,["prevent"]),onTouchmove:D(N,["prevent"]),onTouchend:_},null,544),P("div",A,[T(X(R),{class:"p-button-outlined",onClick:V},{default:Y(()=>[T(n,{icon:"refresh"}),e[0]||(e[0]=M(" Ulangi",-1))]),_:1,__:[0]}),T(X(R),{onClick:U},{default:Y(()=>e[1]||(e[1]=[M("Selesai",-1)])),_:1,__:[1]})])])}}}),et=z(G,[["__scopeId","data-v-54b20cb1"]]);export{et as S};
