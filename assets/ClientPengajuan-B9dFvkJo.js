import{s as U}from"./index-hut-CSFC.js";import{s as r}from"./index-BRvtBi4u.js";import{a as N,c as u,d as K,s as g}from"./index-DiXfYiHA.js";import{d as _,u as H,t as O,l as R}from"./dayjs.min-DJwYnCML.js";import{d as W,P as X,u as Z,a as v,V as c,b as ee,c as k,g as t,h as a,w as i,f as l,i as o,j as ae,F as le,o as w,v as ne,A as $}from"./index-DBMEVp1H.js";import{s as te,S as ie}from"./SignaturePad-K29gDK9R.js";import{r as z,s as y}from"./request-hJgE7wVb.js";import{u as P}from"./userStore-DHvrrwQG.js";import"./index-BApbaFuV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const se={style:{"padding-left":"10%","padding-right":"10%","padding-top":"5rem","padding-bottom":"2rem",display:"flex","flex-flow":"column",gap:"1rem"}},oe={style:{width:"100%",display:"flex","flex-flow":"column",gap:"1rem"}},de={style:{width:"100%",display:"flex","flex-flow":"column",gap:"1rem"}},ue={style:{width:"100%",padding:"25px",border:"1px solid #ccc","border-radius":"15px"}},re={style:{margin:"0",padding:"0"}},me={key:0},pe={style:{padding:"20px",border:"1px solid #ccc"}},ve={key:1,style:{display:"flex","flex-flow":"column",gap:"1rem"}},ye={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},fe={style:{width:"100%",padding:"25px",border:"1px solid #ccc","border-radius":"15px"}},be={style:{margin:"0",padding:"0"}},ge={key:0},ke={style:{padding:"20px",border:"1px solid #ccc"}},we={key:1,style:{display:"flex","flex-flow":"column",gap:"1rem"}},xe={style:{display:"flex","flex-flow":"row wrap","justify-content":"space-between"}},je={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Ve={style:{display:"flex","flex-direction":"column",gap:"0.7rem"}},he={style:{position:"relative",width:"100%",overflow:"none",display:"flex","flex-flow":"column",gap:"1rem"}},_e={style:{display:"flex","flex-direction":"column",gap:"1rem"}},Pe={style:{display:"flex","flex-direction":"column",gap:"0.5rem"}},Ce={style:{display:"flex","flex-direction":"column",gap:"0.5rem"}},Be={key:0,style:{margin:"0",padding:"15px","font-size":"12px",border:"1px solid orange","border-radius":"10px"}},Se={style:{display:"flex","flex-direction":"row",gap:"0.5rem"}},Le={style:{display:"flex","flex-direction":"column",gap:"1rem"}},Ue={key:0,style:{width:"100%",display:"flex","flex-flow":"column",gap:"0.5rem"}},$e={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},Te={style:{display:"flex","flex-flow":"column",gap:"0.1rem",padding:"15px",border:"1px solid #ccc"}},Je={style:{margin:"0",padding:"0"}},De={key:1,style:{width:"100%",display:"flex","flex-flow":"column",gap:"1rem"}},Qe=W({__name:"ClientPengajuan",setup(Ne){_.extend(H),_.extend(O),_.tz.setDefault("Asia/Jakarta"),_.locale(R);const A=X(),x=Z(),C=v(!1),T=v(""),I=v([]),M=()=>{const p={searchKey:T.value};z.post("inventory/search",p).then(e=>{const d=e.payload;I.value=d}).catch(e=>{console.log(e)})},h=v(!1),m=v({}),j=v(1),F=p=>{m.value=p,h.value=!0},f=v([]),b=v([]),E=()=>{if(j.value<1||j.value>m.value.stok){x.add({severity:"error",summary:"Error",detail:"Jumlah peminjaman tidak valid",life:3e3});return}if(f.value.find(e=>e.inv._id===m.value._id)){x.add({severity:"warn",summary:"Peringatan",detail:"Barang sudah ada di daftar pinjam",life:3e3});return}if(m.value.sub_jenis==="Laptop"){if(b.value.find(d=>d.inv._id===m.value._id)){x.add({severity:"warn",summary:"Peringatan",detail:"Barang Laptop sudah ada di daftar pinjam",life:3e3});return}b.value.push({inv:m.value,qty:j.value})}else f.value.push({inv:m.value,qty:j.value}),x.add({severity:"success",summary:"Sukses",detail:"Berhasil menambahkan barang ke keranjang",life:3e3});m.value={},j.value=1,h.value=!1},B=v(!1),S=v(!1),J=new Date,s=v({email:"",date:J,day:"",month:"",year:"",name:P.userData.name||"",nip:P.userData.username||"",jabatan:"",jenis_barang:"",tahun_pengadaan:"",ttd:"",penempatan:"",items:[]}),q=p=>{Y(),s.value.jenis_barang=p,S.value=!0,s.value.items=p==="inv_common"?f.value:b.value},Y=()=>{console.log(J),s.value={email:"",date:J,day:"",month:"",year:"",name:P.userData.name||"",nip:P.userData.username||"",jabatan:"",jenis_barang:"",tahun_pengadaan:"",ttd:"",penempatan:"",items:[]}};c(()=>s.value,()=>{const p=_(s.value.date).format("DD/MM/YYYY").split("/");s.value.day=p[0],s.value.month=p[1],s.value.year=p[2]},{deep:!0});const L=v(!1),G=()=>{if(s.value.name===""||s.value.nip===""||s.value.jabatan===""||s.value.email===""||s.value.tahun_pengadaan===""){x.add({severity:"error",summary:"Error",detail:"Semua field harus diisi",life:3e3});return}L.value=!0},Q=p=>{A.require({message:"Pastikan Tanda Tangan sudah benar dan sesuai. Lanjutkan pengajuan?",header:"Konfirmasi Pengajuan",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Kirim",rejectLabel:"Tidak",rejectClass:"p-button-outlined",accept:()=>{s.value.ttd=p,z.post("pengajuan/propose",s.value).then(e=>{x.add({severity:"success",summary:"Sukses",detail:"Berhasil mengajukan peminjaman",life:3e3}),S.value=!1,L.value=!1,s.value.jenis_barang==="inv_common"?f.value=[]:b.value=[]}).catch(e=>{console.log(e),x.add({severity:"error",summary:"Error",detail:"Gagal mengajukan peminjaman",life:3e3})})},reject:()=>{}})};return ee(()=>{M(),s.value.name=P.userData.name}),(p,e)=>{const d=ae("fasicon");return w(),k(le,null,[t("div",se,[t("div",oe,[e[27]||(e[27]=t("h1",{style:{margin:"0",padding:"0"}},"Pengajuan Peminjaman",-1)),e[28]||(e[28]=t("p",{style:{margin:"0",padding:"0"}}," Peminjaman barang dilakukan melalui prosedur pengajuan yang harus diisi dengan lengkap dan benar. Sesuaikan jenis peminjaman berdasarkan kebutuhan peminjam. Setelah pengajuan dikirim, pihak pengelola akan meninjau dan memberikan persetujuan atau penolakan. ",-1)),a(l(r),{onClick:e[0]||(e[0]=n=>C.value=!0),style:{width:"fit-content"}},{default:i(()=>[a(d,{icon:"plus-circle"}),e[26]||(e[26]=o(" Pilih Barang",-1))]),_:1,__:[26]})]),t("div",de,[t("div",ue,[t("h4",re,[a(d,{icon:"list-alt"}),e[29]||(e[29]=o(" Draft Peminjaman",-1))]),f.value.length<1?(w(),k("div",me,[t("p",pe,[a(d,{icon:"inbox"}),e[30]||(e[30]=o(" Anda belum memilih barang untuk dipinjam.",-1))])])):(w(),k("div",ve,[a(l(N),{value:f.value,responsiveLayout:"scroll",style:{"margin-top":"1rem"},emptyMessage:"Tidak ada data barang yang ditemukan"},{default:i(()=>[a(l(u),{field:"inv.kode_aset",header:"Kode",style:{width:"20%"},sortable:""}),a(l(u),{field:"inv.nama",header:"Barang",style:{width:"40%"},sortable:""}),a(l(u),{field:"inv.jenis",header:"Jenis",style:{width:"20%"},sortable:""}),a(l(u),{field:"inv.sub_jenis",header:"Sub Jenis",style:{width:"20%"},sortable:""}),a(l(u),{header:"Jumlah Pinjam",style:{width:"20%"},sortable:""},{body:i(({data:n})=>[a(l(K),{modelValue:n.qty,"onUpdate:modelValue":V=>n.qty=V,showButtons:"",buttonLayout:"horizontal",style:{"text-align":"center"},min:1,max:n.inv.stok},{incrementbuttonicon:i(()=>e[31]||(e[31]=[t("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:i(()=>e[32]||(e[32]=[t("span",{class:"pi pi-minus"},null,-1)])),_:2},1032,["modelValue","onUpdate:modelValue","max"])]),_:1}),a(l(u),null,{body:i(({data:n})=>[a(l(r),{onClick:V=>f.value=f.value.filter(D=>D.inv._id!==n.inv._id),class:"p-button-outlined p-button-danger",style:{width:"100%"}},{default:i(()=>[a(d,{icon:"trash"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"]),t("div",ye,[a(l(r),{onClick:e[1]||(e[1]=n=>q("inv_common")),style:{width:"fit-content"}},{default:i(()=>e[33]||(e[33]=[o("Ajukan Peminjaman",-1)])),_:1,__:[33]}),a(l(r),{onClick:e[2]||(e[2]=n=>f.value=[]),class:"p-button-outlined",style:{width:"fit-content"}},{default:i(()=>e[34]||(e[34]=[o("Batalkan",-1)])),_:1,__:[34]})])]))]),t("div",fe,[t("h4",be,[a(d,{icon:"list-alt"}),e[35]||(e[35]=o(" Draft Peminjaman Laptop",-1))]),b.value.length<1?(w(),k("div",ge,[t("p",ke,[a(d,{icon:"inbox"}),e[36]||(e[36]=o(" Anda belum memilih barang untuk dipinjam.",-1))])])):(w(),k("div",we,[a(l(N),{value:b.value,responsiveLayout:"scroll",style:{"margin-top":"1rem"},emptyMessage:"Tidak ada data barang yang ditemukan"},{default:i(()=>[a(l(u),{field:"inv.kode_aset",header:"Kode",style:{width:"20%"},sortable:""}),a(l(u),{field:"inv.nama",header:"Barang",style:{width:"40%"},sortable:""}),a(l(u),{field:"inv.jenis",header:"Jenis",style:{width:"20%"},sortable:""}),a(l(u),{field:"inv.sub_jenis",header:"Sub Jenis",style:{width:"20%"},sortable:""}),a(l(u),{header:"Jumlah Pinjam",style:{width:"20%"},sortable:""},{body:i(({data:n})=>[a(l(K),{modelValue:n.qty,"onUpdate:modelValue":V=>n.qty=V,showButtons:"",buttonLayout:"horizontal",style:{"text-align":"center"},min:1,max:n.inv.stok},{incrementbuttonicon:i(()=>e[37]||(e[37]=[t("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:i(()=>e[38]||(e[38]=[t("span",{class:"pi pi-minus"},null,-1)])),_:2},1032,["modelValue","onUpdate:modelValue","max"])]),_:1}),a(l(u),null,{body:i(({data:n})=>[a(l(r),{onClick:V=>b.value=b.value.filter(D=>D.inv._id!==n.inv._id),class:"p-button-outlined p-button-danger",style:{width:"100%"}},{default:i(()=>[a(d,{icon:"trash"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"]),t("div",xe,[t("div",je,[a(l(r),{onClick:e[3]||(e[3]=n=>q("inv_laptop")),style:{width:"fit-content"}},{default:i(()=>e[39]||(e[39]=[o("Ajukan Peminjaman",-1)])),_:1,__:[39]}),a(l(r),{onClick:e[4]||(e[4]=n=>b.value=[]),class:"p-button-outlined",style:{width:"fit-content"}},{default:i(()=>e[40]||(e[40]=[o("Batalkan",-1)])),_:1,__:[40]})]),t("div",null,[a(l(r),{onClick:e[5]||(e[5]=n=>B.value=!0),class:"p-button-outlined"},{default:i(()=>[a(d,{icon:"info-circle"}),e[41]||(e[41]=o(" Ketentuan Peminjaman",-1))]),_:1,__:[41]})])])]))])])]),a(l(U),{header:"Pilih Barang",modal:"",visible:C.value,"onUpdate:visible":e[8]||(e[8]=n=>C.value=n),style:{width:"60vw"},draggable:!1},{default:i(()=>[t("div",Ve,[t("div",he,[a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{onKeyup:M,modelValue:T.value,"onUpdate:modelValue":e[6]||(e[6]=n=>T.value=n),style:{width:"50%"}},null,8,["modelValue"]),e[42]||(e[42]=t("label",null,"Cari barang",-1))]),_:1,__:[42]}),a(l(N),{value:I.value,responsiveLayout:"scroll",style:{"margin-top":"1rem"},emptyMessage:"Tidak ada data barang yang ditemukan"},{default:i(()=>[a(l(u),{field:"kode_aset",header:"Kode",style:{width:"25%"},sortable:""}),a(l(u),{field:"nama",header:"Barang",style:{width:"50%"},sortable:""}),a(l(u),{field:"jenis",header:"Jenis",style:{width:"25%"},sortable:""}),a(l(u),{field:"sub_jenis",header:"Sub",style:{width:"25%"},sortable:""}),a(l(u),{field:"stok",header:"Tersedia",style:{width:"25%"},sortable:""}),a(l(u),null,{body:i(({data:n})=>[a(l(r),{onClick:V=>F(n),class:"p-button-outlined",style:{width:"100%"}},{default:i(()=>[a(d,{icon:"arrow-right"}),e[43]||(e[43]=o(" Pilih",-1))]),_:2,__:[43]},1032,["onClick"])]),_:1})]),_:1},8,["value"]),a(l(r),{style:{width:"fit-content"},onClick:e[7]||(e[7]=n=>C.value=!1),class:"p-button-outlined"},{default:i(()=>[a(d,{icon:"times"}),e[44]||(e[44]=o(" Tutup",-1))]),_:1,__:[44]})])])]),_:1},8,["visible"]),a(l(U),{header:m.value.nama,modal:"",visible:h.value,"onUpdate:visible":e[11]||(e[11]=n=>h.value=n),style:{width:"35vw"}},{default:i(()=>[t("div",_e,[t("div",Pe,[t("span",null,[e[45]||(e[45]=o("Dapat dipinjam: ",-1)),t("b",null,$(m.value.stok)+" unit",1)]),t("span",null,[e[46]||(e[46]=o("Jenis: ",-1)),t("b",null,$(m.value.jenis),1)]),t("span",null,[e[47]||(e[47]=o("Sub-jenis: ",-1)),t("b",null,$(m.value.sub_jenis),1)])]),t("div",Ce,[a(l(K),{modelValue:j.value,"onUpdate:modelValue":e[9]||(e[9]=n=>j.value=n),showButtons:"",buttonLayout:"horizontal",style:{"text-align":"center"},min:1,max:m.value.stok},{incrementbuttonicon:i(()=>e[48]||(e[48]=[t("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:i(()=>e[49]||(e[49]=[t("span",{class:"pi pi-minus"},null,-1)])),_:1},8,["modelValue","max"])]),m.value.sub_jenis==="Laptop"?(w(),k("p",Be,[a(d,{icon:"exclamation-triangle"}),e[50]||(e[50]=o(" Peminjaman ",-1)),e[51]||(e[51]=t("b",null,"Laptop/Notebook/Tablet",-1)),e[52]||(e[52]=o(" wajib mematuhi ketentuan sesuai dengan Peraturan yang tertera pada Surat Izin Pemakaian ",-1))])):ne("",!0),t("div",Se,[a(l(r),{onClick:e[10]||(e[10]=n=>h.value=!1),class:"p-button-outlined",style:{width:"100%"}},{default:i(()=>[a(d,{icon:"xmark"}),e[53]||(e[53]=o(" Batal",-1))]),_:1,__:[53]}),a(l(r),{onClick:E,class:"p-button-primary",style:{width:"100%"}},{default:i(()=>[a(d,{icon:"check"}),e[54]||(e[54]=o(" Selesai",-1))]),_:1,__:[54]})])])]),_:1},8,["header","visible"]),a(l(U),{visible:B.value,"onUpdate:visible":e[13]||(e[13]=n=>B.value=n),header:"Kebijakan Peminjaman Laptop/Notebook/Tablet",modal:"",style:{width:"50vw"},draggable:!1},{default:i(()=>[t("div",Le,[e[56]||(e[56]=t("ol",null,[t("li",null,"Pemakai bertanggung jawab atas keamanan Laptop/Notebook/Tablet tersebut dari bahaya pencurian dan perlindungan dari kerusakan baik disengaja maupun tidak disengaja saat waktu dinas maupun diluar dinas."),t("li",null,"Laptop tidak boleh dipinjamkan/dipindahkan tangankan kepada pihak lain tanpa memberitahu kepada Kepala Sub Bagian Perlengkapan dan Pengadaan Barang/Jasa UIN Sulthan Thaha Saifuddin Jambi."),t("li",null,"Jika terjadi kehilangan/kerusakan pada saat jam dinas dan diluar jam dinas akan dikenakan ganti rugi dan perbaikan, sesuai peraturan yang berlaku."),t("li",null,"Sehabis masa jabatan (mutasi/pensiun), harus menyerahkan kembali Barang Milik Negara (BMN) tersebut kepada UIN Sulthan Thaha Saifuddin Jambi melalui Sub Bagian Perlengkapan dan Pengadaan Barang/Jasa.")],-1)),a(l(r),{style:{width:"fit-content"},onClick:e[12]||(e[12]=n=>B.value=!1),class:"p-button-outlined"},{default:i(()=>[a(d,{icon:"check"}),e[55]||(e[55]=o(" Mengerti & Tutup",-1))]),_:1,__:[55]})])]),_:1},8,["visible"]),a(l(U),{modal:"",style:{width:"35vw"},header:"Formulir Pengajuan",visible:S.value,"onUpdate:visible":e[25]||(e[25]=n=>S.value=n)},{default:i(()=>[L.value?(w(),k("div",De,[e[67]||(e[67]=t("p",{style:{margin:"0",padding:"0"}},"Silakan tanda tangani formulir pengajuan di bawah ini menggunakan mouse atau layar sentuh.",-1)),a(ie,{"onUpdate:signature":Q,width:500,height:300,style:{border:"1px solid #ccc"}}),a(l(r),{class:"p-button-outlined",onClick:e[24]||(e[24]=n=>L.value=!1),style:{width:"fit-content"}},{default:i(()=>[a(d,{icon:"arrow-left"}),e[66]||(e[66]=o(" Kembali",-1))]),_:1,__:[66]})])):(w(),k("div",Ue,[a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{modelValue:s.value.name,"onUpdate:modelValue":e[14]||(e[14]=n=>s.value.name=n),style:{width:"100%"}},null,8,["modelValue"]),e[57]||(e[57]=t("label",null,"Nama Lengkap",-1))]),_:1,__:[57]}),a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{modelValue:s.value.nip,"onUpdate:modelValue":e[15]||(e[15]=n=>s.value.nip=n),style:{width:"100%"}},null,8,["modelValue"]),e[58]||(e[58]=t("label",null,"NIP",-1))]),_:1,__:[58]}),a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{modelValue:s.value.jabatan,"onUpdate:modelValue":e[16]||(e[16]=n=>s.value.jabatan=n),style:{width:"100%"}},null,8,["modelValue"]),e[59]||(e[59]=t("label",null,"Jabatan",-1))]),_:1,__:[59]}),a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{modelValue:s.value.email,"onUpdate:modelValue":e[17]||(e[17]=n=>s.value.email=n),style:{width:"100%"}},null,8,["modelValue"]),e[60]||(e[60]=t("label",null,"E-mail",-1))]),_:1,__:[60]}),a(l(g),{variant:"in"},{default:i(()=>[a(l(te),{modelValue:s.value.date,"onUpdate:modelValue":e[18]||(e[18]=n=>s.value.date=n),style:{width:"100%"},dateFormat:"dd/mm/yy",showIcon:""},null,8,["modelValue"]),e[61]||(e[61]=t("label",null,"Tanggal",-1))]),_:1,__:[61]}),t("div",$e,[a(l(y),{disabled:"",style:{width:"120px"},modelValue:s.value.day,"onUpdate:modelValue":e[19]||(e[19]=n=>s.value.day=n)},null,8,["modelValue"]),a(l(y),{disabled:"",style:{width:"120px"},modelValue:s.value.month,"onUpdate:modelValue":e[20]||(e[20]=n=>s.value.month=n)},null,8,["modelValue"]),a(l(y),{disabled:"",style:{width:"120px"},modelValue:s.value.year,"onUpdate:modelValue":e[21]||(e[21]=n=>s.value.year=n)},null,8,["modelValue"])]),t("div",Te,[e[62]||(e[62]=t("label",{style:{"font-size":"13px"}},"Jenis Barang",-1)),t("p",Je,[t("b",null,$(s.value.jenis_barang==="inv_laptop"?"Laptop":"Umum"),1)])]),a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{type:"number",modelValue:s.value.tahun_pengadaan,"onUpdate:modelValue":e[22]||(e[22]=n=>s.value.tahun_pengadaan=n),style:{width:"100%"},min:2e3,max:2026},null,8,["modelValue"]),e[63]||(e[63]=t("label",null,"Tahun Pengadaan",-1))]),_:1,__:[63]}),a(l(g),{variant:"in"},{default:i(()=>[a(l(y),{modelValue:s.value.penempatan,"onUpdate:modelValue":e[23]||(e[23]=n=>s.value.penempatan=n),style:{width:"100%"}},null,8,["modelValue"]),e[64]||(e[64]=t("label",null,"Lokasi Penempatan",-1))]),_:1,__:[64]}),a(l(r),{onClick:G},{default:i(()=>e[65]||(e[65]=[o("Lanjutkan",-1)])),_:1,__:[65]})]))]),_:1},8,["visible"])],64)}}});export{Qe as default};
